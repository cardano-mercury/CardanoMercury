id: 60088
name: cardanomercury
environments:

    production:
        # domain: 'todo'
        storage: production-cardanomercury-storage
        timeout: 60
        memory: 1024
        cli-memory: 512
        queue-memory: 512
        queue-timeout: 600
        cli-timeout: 600
        runtime: docker
        database: production-mysql
        cache: production-redis
        # TODO: AWS Managed Firewall (WAF)
        build:
          - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --no-dev'
          - 'php artisan optimize'
          - 'php artisan event:cache'
          - 'php artisan config:cache'
          - 'npm install && npm run build && rm -rf node_modules'
        deploy:
          - 'php artisan migrate --force'

    staging:
        domain: 'staging.cardano-mercury.io'
        storage: staging-cardanomercury-storage
        timeout: 60
        memory: 1024
        cli-memory: 512
        queue-memory: 512
        queue-timeout: 600
        cli-timeout: 600
        runtime: docker
        database: staging-mysql
        cache: staging-redis
        # TODO: AWS Managed Firewall (WAF)
        build:
            - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --no-dev'
            - 'php artisan optimize'
            - 'php artisan event:cache'
            - 'php artisan config:cache'
            - 'npm install && npm run build && rm -rf node_modules'
        deploy:
          - 'php artisan migrate'
